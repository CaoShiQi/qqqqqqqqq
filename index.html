<!DOCTYPE html>
<!--HTML5 doctype-->
<html>
    <head>        
    	<script>
			(function() {
				if ("-ms-user-select" in document.documentElement.style && navigator.userAgent.match(/IEMobile\/10\.0/)) {
					var msViewportStyle = document.createElement("style");
					msViewportStyle.appendChild(
						document.createTextNode("@-ms-viewport{width:auto!important}")
					);
					document.getElementsByTagName("head")[0].appendChild(msViewportStyle);
				}
			})();
		</script>
        <title>phonegap中文网</title>
        <meta http-equiv="Content-type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0">
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <META HTTP-EQUIV="Pragma" CONTENT="no-cache">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />        
        <link rel="stylesheet" type="text/css" href="css/icons.css" />    
 		<link rel="stylesheet" type="text/css" href="css/af.ui.css" title="default" />         
        <link rel="stylesheet" type="text/css" href="css/basic.css" title="default" />         
        <script type="text/javascript" charset="utf-8" src="./appframework.min.js"></script>        
    	<script>           
            if (!((window.DocumentTouch && document instanceof DocumentTouch) || 'ontouchstart' in window)) {
                var script = document.createElement("script");
                script.src = "plugins/af.desktopBrowsers.js";
                var tag = $("head").append(script);
            }
        </script>
        <!--项目中常用的一些插件-->
        <script type="text/javascript" charset="utf-8" src="./plugins/af.actionsheet.js"></script>
        <script type="text/javascript" charset="utf-8" src="./plugins/af.css3animate.js"></script>
        <script type="text/javascript" charset="utf-8" src="./plugins/af.passwordBox.js"></script>
        <script type="text/javascript" charset="utf-8" src="./plugins/af.scroller.js"></script>
        <script type="text/javascript" charset="utf-8" src="./plugins/af.selectBox.js"></script>
        <script type="text/javascript" charset="utf-8" src="./plugins/af.touchEvents.js"></script>
        <script type="text/javascript" charset="utf-8" src="./plugins/af.touchLayer.js"></script>
        <script type="text/javascript" charset="utf-8" src="./plugins/af.popup.js"></script>

        <script type="text/javascript" charset="utf-8" src="./ui/src/appframework.ui.js"></script>
        <!-- <script type="text/javascript" charset="utf-8" src="./ui/transitions/all.js"></script> -->            
        
        <script type="text/javascript" charset="utf-8" src="./ui/transitions/fade.js"></script>
        <script type="text/javascript" charset="utf-8" src="./ui/transitions/flip.js"></script>
        <script type="text/javascript" charset="utf-8" src="./ui/transitions/pop.js"></script>
        <script type="text/javascript" charset="utf-8" src="./ui/transitions/slide.js"></script>
        <script type="text/javascript" charset="utf-8" src="./ui/transitions/slideDown.js"></script>
        <script type="text/javascript" charset="utf-8" src="./ui/transitions/slideUp.js"></script>
        
        <script type="text/javascript" charset="utf-8" src="./plugins/af.slidemenu.js"></script> 
        
        <script type="text/javascript" src="./common.js"></script>    
        <script type="text/javascript" src="./basic.js"></script>         
        
        <script>
        	$.ui.ready(function(){ 
				$("#afui").get(0).className='bb'; //设置属于那种风格 
			});
			            
            var webRoot = "./";   //定义网站的根目录
            // $.os.android=true;
            $.ui.autoLaunch = false;
            $.ui.openLinksNewTab = false;
            //$.ui.resetScrollers=false;
            //这句话要加上
            $(document).ready(function(){
                   $.ui.launch();
				   getPortalCate();//获取文章分类
  				   getThreadCate();//获取帖子分类

            });            
            /* This code is used to run as soon as appMobi activates */
            var onDeviceReady = function () {
                AppMobi.device.setRotateOrientation("portrait");
                AppMobi.device.setAutoRotate(false);
                webRoot = AppMobi.webRoot + "";
                //hide splash screen
                AppMobi.device.hideSplashScreen();
                $.ui.blockPageScroll(); //block the page from scrolling at the header/footer
                $.ui.launch();

            };
            document.addEventListener("intel.xdk.device.ready", onDeviceReady, false);
			
			
			//切换显示隐藏
            function showHide(obj, objToHide) {
                var el = $("#" + objToHide)[0];

                if (obj.className == "expanded") {
                    obj.className = "collapsed";
                } else {
                    obj.className = "expanded";
                }
                $(el).toggle();

            }
        </script>
   
</head>

    <body>
        <div id="afui" class="bb">
        	<div id="content">
            	
                <!--站长资讯-->
                <div title='站长资讯' id="main_panel" class="panel" selected="true" data-tab="navbar_home" data-footer="footerui" data-header="headerui">
                 
                  <h2 class='expanded' onclick='showHide(this,"main_info");'>PhoneGap中文网</h2>

                    <p id='main_info'>PhoneGap中文网是国内最大的跨平台移动互联网软件开发中文门户网之一，提供JqueryMobile教程 phonegap教程 senchar视频教程下载学习</p>
                    <ul class="listview" id="portalCateList">                        
                       222                        

                    </ul>
                </div>  
                
                 <!--资讯列表-->
                <div title='资讯列表' id="article_list_panel" data-load="portal_list_load" data-unload='portal_list_uload' class="panel" data-tab="navbar_home" data-footer="footerui" data-header="headerui">
                 
                 
                    <ul class="listview article_list" id="articleList">                        
                                            
                    </ul>   
                    <p><a class="button block" id="portalListButton" onClick="portalListmore();">点击加载更多</a></p> 
                    
                </div>  
                
                
                
                
                
                 <!--站长论坛-->
                <div title='站长论坛' id="forum_panel" class="panel" data-tab="navbar_forum" data-footer="footerui" data-header="headerui" data-nav="forum_nav">
                 	  <ul class="listview" id="threadCateList">
                        
                      </ul>  
                 
                </div>  
                
                 <!--帖子列表-->
                <div title='帖子列表' id="forum_list_panel" data-load="forum_list_load" data-unload='forum_list_uload' class="panel" data-tab="navbar_forum" data-footer="footerui" data-header="headerui_post" data-nav="forum_nav">                 
                  <ul class="listview article_list" id="threadList">
                  
                  </ul>                 
                   <p><a class="button block" id="threadListButton" onClick="threadListmore();">点击加载更多</a></p>    
                  
                </div> 
                
                
                
                 <!--用户中心-->
                <div title='用户中心' id="user_panel" class="panel" data-tab="navbar_user" data-footer="footerui" data-header="headerui">
               	      
                            
                   <p class="center">
                        <div id="login_info">
                       
                        </div>
                        <script type="text/javascript">
                  	if(getItem('uid')&&getItem('uid')!=''&&getItem('username')&&getItem('username')!=''&&getItem('salt')&&getItem('salt')!=''){
						var login_info='<p>用户名'+getItem('username')+'</p>'	;						
						
					}else{
						 var lgoin_info='<p class="center top10">您需要登录才能使用用户中心的功能</p>';
						 login_info+='<p><a class="button login_button" href="javascript:showPopupLogin();">立即登录</a>            </p>';
						 	
						
					}									
					$('#login_info').html(login_info);
                  </script>   
                    	
                    <p>与我相关：</p>
                    <ul class="list inset">
                        <li>
                            <a href="#" data-ignore="True" class="icon question">我要提问</a>
                        </li>
                        <li>
                            <a href="#" data-ignore="True" class="icon chat">我的帖子</a>
                        </li>                 
                    </ul>
                    <p>账户：</p>
                    <ul class="list inset">
                        <li>
                            <a href="http://www.phonegap100.com/member.php?mod=register_phonegap" data-ignore="True" class="icon user">注册账户</a>
                        </li>
                        <li>
                            <a href="http://www.phonegap100.com" data-ignore="True"  class="icon key">修改密码</a>
                        </li>                 
                    </ul>
                    <p>其他：</p>
                    <ul class="list inset">
                        <li>
                            <a href="http://www.phonegap100.com" data-ignore="True" class="icon cloud">phonegap中文网</a>
                        </li>
                        <li>
                            <a href="http://www.phonegap100.com" data-ignore="True"  class="icon info">关于我们</a>
                        </li>                 
                    </ul>                        
                        
                </div>      
                
                
                <div title='发帖' id="forum_post_panel" class="panel" data-tab="navbar_user" data-footer="footerui" data-header="headerui">
               	 	<div class="formGroupHead">发帖</div>            
                    <form>
                    <div class="input-group">                   
                        <input type="text" id="post_title1" placeholder="帖子标题">           
                         <select id="post_select" class="post_select" style="-webkit-appearance: listbox;" >
                            <option value="0">帖子分类</option>
                            <option value="1">One</option>
                            <option value="2">Two</option>
                            <option value="3">Three</option>
                        </select>             
                        <textarea id="post_content1" rows="6" placeholder="帖子内容"></textarea>
                        <input style="float:right;" class="button" type="button" name="post_button" id="post_button" value="确定发表" />
                    </div>
                </form>    
                </div> 
                <!--header-->
                <header id="headerui">
                     <a style="float:left;" onclick='af.ui.toggleSideMenu()' class='menuButton'></a>               
                     <h1>phonegap中文网</h1>
                     <a  href='#user_panel' style="float:right; padding:8px 5px 0px 0px; color:#fff; border:none; text-decoration:none;" class="icon user big"></a>
                </header>
                
                 <header id="headerui_post">
                     <a style="float:left;" onclick='af.ui.toggleSideMenu()' class='menuButton'></a>               
                     <h1>phonegap中文网</h1>
                     <a  href='javascript:newthreadPost();' style="float:right;padding:8px 5px 0px 0px; color:#fff; border:none; text-decoration:none;" class="icon pencil big">发帖</a>
                </header>
                
                
                
                 <!--footer-->
                 <footer id='footerui'>
                    <a href="#main_panel" id='navbar_home' class='icon message'>站长资讯 </a>                	<a href='#forum_panel' id="navbar_forum" class='icon chat'>站长论坛</a>
                    <a href='#user_panel' id="navbar_user" class='icon user'>用户中心</a>        
                </footer> 
                
                 <nav>
                    <ul class="list side_nav" id="portalCate">
                        <li><a href="#main_panel">首页</a></li>
                        <li><a href="#home">视频教程</a></li>
                        <li><a href="#home">PhoneGap平台资讯</a></li>
                        <li><a href="#home">移动互联网</a></li>
                        <li><a href="#home">PhoneGap资讯</a></li>
                        <li><a href="#home">赞助视频教程</a></li> 
                    </ul>
                </nav>                
                <nav id="forum_nav">
                    <ul class="list side_nav" id="threadCate">
                            <li><a href="#main_panel">首页</a></li>                                  
                      
                    </ul>
                </nav>
                
            </div>        	
	    </div>
         <script type="text/javascript">
		 
		 
		 	//发表帖子
            function newthreadPost() {
				$("#afui").popup({
					title: "发表帖子",
					message: "帖子标题: <input type='text' id='post_title'><br> 帖子内容 ： <textarea id='post_content' rows='6' placeholder='帖子内容'></textarea>",
					cancelText: "取消",
					cancelCallback: function () {},
					doneText: "发表",
					doneCallback: function () {
						//处理登录的一些操作
						var title=$('#post_title').val();
						
						var content=$('#post_content').val();
						
						var uid=getItem('uid');
						
						var username=getItem('username');	
											
						var fid=getItem('forum_list_fid');												
						//var tid=2;
						var threadList='';
						
						$.jsonP({										
							url:serverURL+'/appapi.php?a=threadPost&title='+title+'&content='+content+'&uid='+uid+'&username='+username+'&fid='+fid+'&callback=?',	
							success:function(data){
								//发表成功或者发表失败					
								
								if(data.success==true){
										
									threadList+="<li class='clearfix' onclick=\"setItem('thread_content_tid','"+data.tid+"')\">";	
													
									threadList+='<a href="forum_content.html" data-refresh-ajax="true"><img src="images/user.gif" /><p>'+title+'</p></a></li>'									
								
								  $("#threadList").prepend(threadList);
			
																					
								}else{	
									alert(data.message);
									newthreadPost();
								}
								
								
							}
						});
					
						
						
						//alert("登录中");							
					},
					cancelOnly: false
				});
		   }

		 	//用户登录
            function showPopupLogin() {
				$("#afui").popup({
					title: "用户登录",
					message: "用户名: <input type='text' id='username' class='af-ui-forms'><br>密码: <input type='password' id='password' class='af-ui-forms' style='webkit-text-security:disc'>",
					cancelText: "取消",
					cancelCallback: function () {},
					doneText: "登录",
					doneCallback: function () {
						//处理登录的一些操作
						var username=$('#username').val();
						var password=$('#password').val();		
						//alert(username);			
						//alert(password);		
						if(username==''||password==''){
							alert('用户名或者密码不能为空');
							showPopupLogin();
						}else{
							$.jsonP({										
								url:serverURL+'/appapi.php?a=login&username='+username+'&password='+password+'&callback=?',	
								success:function(data){									
									if(data.success==false){
										alert(data.message);										
										showPopupLogin();
										$('#username').val(username);
									}else{	
									
										alert(data['result'].username);									
										setItem('uid',data['result'].uid); //用户id
										setItem('username',data['result'].username);//用户名
										setItem('salt',data['result'].salt);//用户的唯一标识
									}
								}
							});		
							
						}
						
						
					},
					cancelOnly: false
				});
			}
        </script>
    </body>
</html>
